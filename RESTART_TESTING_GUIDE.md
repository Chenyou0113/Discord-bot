# 重啟功能測試指南

## 🎯 測試目標
驗證機器人重啟功能已修復，可以正確重啟而不是只關閉

## 📋 測試步驟

### 步驟 1：使用自動重啟腳本啟動機器人

#### 選項 A：批次檔版本（簡單）
```bat
auto_restart_bot.bat
```

#### 選項 B：PowerShell 版本（推薦）
```powershell
.\auto_restart_bot.ps1
```

### 步驟 2：等待機器人完全啟動
- 看到 "🚀 正在啟動 Discord Bot..." 訊息
- 等待機器人在 Discord 中顯示為線上狀態

### 步驟 3：測試 Discord 重啟指令

#### 方法 A：使用傳統指令
在 Discord 中輸入：
```
!reboot
```
或
```
!rb
```

#### 方法 B：使用斜線指令（需管理員權限）
```
/restart
```

### 步驟 4：觀察重啟過程

#### 預期行為：
1. ✅ 機器人回應重啟訊息
2. ✅ 機器人在 Discord 中顯示為離線
3. ✅ 自動重啟腳本顯示"機器人正常關閉，準備重啟..."
4. ✅ 等待 3 秒後自動重新啟動
5. ✅ 機器人重新上線並正常運作

#### 如果出現問題：
- ❌ 機器人關閉但未重啟 → 檢查是否使用了自動重啟腳本
- ❌ 出現錯誤訊息 → 檢查 Discord Token 和網路連線
- ❌ 重啟失敗 → 查看控制台錯誤訊息

### 步驟 5：驗證功能正常

#### 測試基本功能：
```
/help
```

#### 測試自動搜尋功能：
1. 確保已啟用：`/auto_search enable:True`
2. 發送包含"搜尋"的訊息測試

## 🔧 進階測試

### 測試 PowerShell 進階選項

#### 自動模式測試
```powershell
.\auto_restart_bot.ps1 -NoWait
```

#### 限制重啟次數測試
```powershell
.\auto_restart_bot.ps1 -MaxRestarts 5
```

### 測試異常處理

#### 模擬 Token 錯誤
1. 暫時修改 .env 中的 DISCORD_TOKEN
2. 觀察腳本如何處理錯誤
3. 恢復正確的 Token

## 📊 測試結果記錄

### ✅ 成功標準
- [ ] 機器人可以正常啟動
- [ ] `!reboot` 指令正常響應
- [ ] 機器人關閉後自動重啟
- [ ] 重啟後所有功能正常
- [ ] 自動搜尋功能正常運作

### ❌ 失敗跡象
- 機器人關閉後不重啟
- 重啟過程中出現錯誤
- 重啟後功能異常
- 無限重啟循環

## 🚨 緊急情況處理

### 如果出現無限重啟循環
1. 按 `Ctrl+C` 停止自動重啟腳本
2. 檢查機器人程式碼是否有錯誤
3. 確認 Discord Token 有效性
4. 查看 bot.log 錯誤日誌

### 如果機器人無法啟動
1. 檢查網路連線
2. 驗證所有環境變數設定
3. 確認虛擬環境啟用正確
4. 使用基本啟動腳本測試

## 🎉 測試完成確認

當看到以下現象時，表示重啟功能修復成功：

1. ✅ 使用 `!reboot` 指令後機器人自動重啟
2. ✅ 重啟過程順暢無錯誤
3. ✅ 重啟後所有功能正常運作
4. ✅ 自動重啟腳本正確監控機器人狀態

**🎊 恭喜！重啟功能已完全修復並可正常使用！**
