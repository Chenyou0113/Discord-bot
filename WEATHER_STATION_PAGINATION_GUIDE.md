# 氣象站翻頁功能使用說明

## 🌡️ 功能概述

新增的氣象站翻頁功能讓用戶在查詢多個氣象站資料時能夠方便地瀏覽所有結果，避免因資料過多而導致的顯示問題。

## 📋 指令使用方式

### `/weather_station` 指令參數

- **無參數**: 顯示全台主要縣市氣象概況（包含重新整理按鈕）
- **station_id**: 查詢指定測站代碼的詳細資料（如：466920）
- **location**: 查詢指定地區的氣象站資料（如：台北、高雄）

## 🔘 翻頁按鈕功能

### 按鈕類型

1. **◀️ 上一頁**: 切換到前一頁（第一頁時會停用）
2. **頁面資訊**: 顯示當前頁數/總頁數（不可點擊）
3. **下一頁 ▶️**: 切換到下一頁（最後一頁時會停用）
4. **🔄 重新整理**: 重新獲取最新的氣象站資料

### 觸發條件

- **單一測站**: 直接顯示詳細資料，無翻頁按鈕
- **多個測站** (>5個): 自動分頁顯示，每頁5個測站
- **全台概況**: 顯示主要縣市，包含重新整理按鈕

## 📊 顯示格式

### 地區查詢（多測站）
```
🌡️ 台北 地區氣象觀測
第 1/3 頁 (共 12 個測站)

📍 測站名稱 (測站代碼)
🌡️ 溫度 | 💧 濕度 天氣狀況
📍 所在位置
```

### 單一測站詳細資料
```
🌡️ 測站名稱 氣象觀測
測站代碼: 466920

☁️ 天氣: 晴
🌡️ 溫度: 25°C
💧 相對濕度: 65%
📊 氣壓: 1013 hPa
🧭 風向: 120°
💨 風速: 3.2 m/s
🌧️ 降雨量: 0 mm
📍 位置: 台北市大安區
```

## ⚡ 功能特色

### 智能分頁
- 每頁最多顯示5個測站，避免資訊過載
- 自動計算總頁數
- 頁面邊界智能處理

### 用戶權限控制
- 只有發起查詢的用戶可以操作按鈕
- 其他用戶點擊會收到權限提示

### 資料更新
- 重新整理按鈕可獲取最新資料
- 自動重新篩選和分頁
- 保持當前頁面位置（如果可能）

### 錯誤處理
- API 失敗時的友善提示
- 自動重試機制
- 異常狀況的優雅處理

## 🎯 使用範例

### 查詢台北地區氣象站
```
/weather_station location:台北
```
→ 顯示台北地區所有氣象站資料，如果超過5個會自動分頁

### 查詢特定測站
```
/weather_station station_id:466920
```
→ 顯示台北測站的詳細氣象資料

### 查詢全台概況
```
/weather_station
```
→ 顯示主要縣市氣象概況，包含重新整理功能

## 🔧 技術實現

### WeatherStationView 類
- 繼承自 discord.ui.View
- 支援按鈕互動和頁面管理
- 5分鐘自動逾時設定

### 分頁邏輯
- 每頁顯示數量: 5個測站
- 動態按鈕狀態更新
- 智能頁面邊界檢查

### 資料處理
- 即時 API 資料獲取
- 智能地區名稱匹配
- 結構化資料格式化

---

**更新時間**: 2025年6月24日  
**版本**: v1.0  
**狀態**: ✅ 已完成並測試
