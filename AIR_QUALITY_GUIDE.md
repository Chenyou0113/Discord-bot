# 空氣品質查詢功能說明

## 功能概述

這個功能為 Discord 機器人新增了查詢環保署空氣品質監測資料的能力。使用者可以通過斜線指令查詢全台各地的空氣品質資訊，包括 AQI 指數、各項污染物濃度等詳細資料。

## 資料來源

- **資料提供**: 行政院環境保護署
- **更新頻率**: 每小時更新
- **涵蓋範圍**: 全台灣所有空氣品質監測站
- **API 來源**: https://data.epa.gov.tw/api/v2/aqx_p_432

## 可用指令

### 1. `/air_quality` - 關鍵字搜尋
**功能**: 根據關鍵字搜尋空氣品質監測站
**參數**:
- `query` (必填): 搜尋關鍵字（測站名稱、縣市或位置）
- `page` (選填): 頁數，預設為第1頁

**使用範例**:
```
/air_quality query:台北
/air_quality query:板橋 page:2
/air_quality query:學校
/air_quality query:工業區
```

### 2. `/air_quality_county` - 縣市查詢
**功能**: 按縣市查詢空氣品質監測站
**參數**:
- `county` (必填): 縣市名稱
- `page` (選填): 頁數，預設為第1頁

**使用範例**:
```
/air_quality_county county:新北市
/air_quality_county county:台北市 page:2
/air_quality_county county:高雄市
/air_quality_county county:花蓮縣
```

### 3. `/air_quality_site` - 特定測站詳細資訊
**功能**: 查詢特定測站的詳細空氣品質資訊
**參數**:
- `site_name` (必填): 測站名稱

**使用範例**:
```
/air_quality_site site_name:板橋
/air_quality_site site_name:士林
/air_quality_site site_name:前金
```

## AQI 指數說明

### AQI 等級分類

| AQI 範圍 | 等級 | 顏色 | 符號 | 健康影響 |
|----------|------|------|------|----------|
| 0-50 | 良好 | 🟢 綠色 | 🟢 | 空氣品質為良好，對一般大眾的健康沒有影響 |
| 51-100 | 普通 | 🟡 黃色 | 🟡 | 空氣品質為普通，對敏感族群可能造成輕微影響 |
| 101-150 | 對敏感族群不健康 | 🟠 橙色 | 🟠 | 敏感族群可能出現健康影響，一般大眾較不受影響 |
| 151-200 | 對所有族群不健康 | 🔴 紅色 | 🔴 | 所有人都可能開始出現健康影響 |
| 201-300 | 非常不健康 | 🟣 紫色 | 🟣 | 所有人都可能出現嚴重健康影響 |
| 301+ | 危害 | 🟤 棕色 | 🟤 | 所有人都會受到嚴重健康影響 |

### 敏感族群包括
- 患有心臟病、肺病的成人和兒童
- 老年人
- 兒童
- 孕婦

## 顯示資訊內容

### 測站列表顯示
```
🌬️ 空氣品質查詢結果

📍 查詢: 台北
📊 找到 12 個測站 | 📄 第 1/2 頁

📋 測站列表
1. 🟡 台北 (台北市) - AQI: 85
2. 🟢 士林 (台北市) - AQI: 45
3. 🟠 中山 (台北市) - AQI: 105
...
```

### 測站詳細資訊
```
🟡 板橋 空氣品質
📍 新北市

🌡️ AQI 指數: 85 - 普通

🧪 污染物濃度:
PM2.5: 25 μg/m³
PM10: 45 μg/m³
O₃: 65 ppb

📊 其他污染物:
CO: 0.8 ppm
SO₂: 12 ppb
NO₂: 28 ppb

💡 健康建議:
空氣品質為普通，對敏感族群可能造成輕微影響

⏰ 更新時間: 2025-01-05 14:00
📡 測站狀態: 正常
```

## 互動功能

### 詳細資訊按鈕
- 每個測站列表都提供「查看詳細資訊」按鈕
- 點擊後顯示完整的空氣品質監測資料
- 包含所有污染物濃度和健康建議

### 分頁瀏覽
- 自動分頁顯示（每頁最多10個測站）
- 顯示當前頁數和總頁數
- 提供翻頁提示

## 污染物說明

### 主要污染物
- **PM2.5**: 細懸浮微粒，粒徑小於2.5微米
- **PM10**: 懸浮微粒，粒徑小於10微米
- **O₃**: 臭氧，地面臭氧濃度
- **CO**: 一氧化碳
- **SO₂**: 二氧化硫
- **NO₂**: 二氧化氮

### 單位說明
- **μg/m³**: 微克/立方公尺（用於懸浮微粒）
- **ppb**: 十億分之一（用於氣體污染物）
- **ppm**: 百萬分之一（用於一氧化碳）

## 使用技巧

### 1. 精確搜尋
```
# 使用完整測站名稱
/air_quality_site site_name:板橋

# 使用部分關鍵字
/air_quality query:板
```

### 2. 地區探索
```
# 查看整個縣市的空氣品質
/air_quality_county county:新北市

# 搜尋特定地區
/air_quality query:工業區
/air_quality query:學校
```

### 3. 分頁瀏覽
```
# 查看第一頁
/air_quality query:台北

# 根據結果翻頁
/air_quality query:台北 page:2
```

## 快取機制

- **快取時間**: 30分鐘
- **目的**: 減少 API 請求，提升回應速度
- **更新**: 快取過期後自動重新獲取最新資料

## 錯誤處理

### 常見錯誤情況
1. **找不到測站**: 檢查拼寫或嘗試使用部分關鍵字
2. **頁數超出範圍**: 使用指令顯示的頁數範圍
3. **API 連線失敗**: 稍後重試，或檢查網路狀況
4. **資料暫時無法取得**: 環保署 API 維護期間

### 故障排除
- 確認測站名稱拼寫正確
- 嘗試使用縣市查詢代替關鍵字搜尋
- 等待幾分鐘後重新嘗試

## 健康建議

### 根據 AQI 等級的建議活動

**良好 (0-50)** 🟢
- 適合所有戶外活動

**普通 (51-100)** 🟡
- 一般人可進行戶外活動
- 敏感族群應減少長時間戶外活動

**對敏感族群不健康 (101-150)** 🟠
- 敏感族群應避免戶外活動
- 一般人減少長時間戶外活動

**對所有族群不健康 (151-200)** 🔴
- 所有人應避免戶外活動
- 室內活動時應關閉門窗

**非常不健康 (201-300)** 🟣
- 所有人應留在室內
- 避免戶外活動和運動

**危害 (301+)** 🟤
- 所有人應留在室內並避免體力消耗
- 考慮佩戴防護口罩

## 資料準確性

- 資料直接來源於環保署官方 API
- 即時更新，反映最新監測結果
- 所有數值均為官方認證資料

---

**功能特色**: 即時查詢、詳細資訊、健康建議、互動操作  
**適用對象**: 關心空氣品質的所有使用者  
**更新頻率**: API 資料每小時更新  
**版本**: v1.0
